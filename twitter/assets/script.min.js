$(function(){function e(){var e=$("textarea").attr("maxlength"),t=$("textarea").val().length;$("#140tweet").text(e-t)}var t=localStorage.getItem("imageData").replace("data:image/png;base64,","");$("#tweet").on("click",function(){if($("#140tweet").text()>=0){if($(this).blur(),$("#overlay")[0])return!1;$("body").append('<div id="overlay"><div class="loader"></div></div>'),$("#overlay").fadeIn("slow");var e=$("#oauth_token").val(),a=$("#oauth_token_secret").val(),o=$(".radio").find("input:radio:checked").val(),n=$('textarea[name="tweTxt"]').val(),r=function(){return"yes"==o?n+" #フレ石編成的ななにか":"no"==o?n:void 0}();$.ajax({url:"tweet.php",type:"post",dataType:"json",data:{oauth_token:e,oauth_token_secret:a,imgUrl:t,tweTxt:r}}).done(function(e){$("#overlay").fadeOut("slow",function(){$("#overlay").remove(),$("#tweet").after("<p>ツイートに成功しました。</p>"),localStorage.removeItem("imageData")})}).fail(function(){$("#overlay").fadeOut("slow",function(){$("#overlay").remove(),$("#tweet").after("<p>ツイートに失敗しました。<br>このウィンドウを閉じ、改めてお試し下さい。</p>")})})}else alert("文字数がオーバーしてます。")}),$(".radio").on("click",function(t){var a=$(this).find("input:radio:checked").val(),o=function(){return"yes"==a?"128":"no"==a?"140":void 0}();console.log(o),$("textarea").attr("maxlength",o),e()}),$("textarea").bind("keydown keyup keypress change",function(){e()})});